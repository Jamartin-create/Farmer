# 水 / 肥料 / 向日葵（规则与实战建议）

本文整理《The Farmer Was Replaced》中与**浇水**、**肥料**、**向日葵能量**相关的规则，供脚本实现与策略调整时对照。

## 浇水（Water）

### 基本规则

- 地块含水量范围：`0 ~ 1`
- `get_water()`：返回无人机当前脚下地块的含水量
- 生长速度加成：含水量从 0 到 1 时，植物生长速度从 **1×** 线性提升到 **5×**
- 干燥机制：地块会随时间变干，平均每秒失去**当前含水量的 1%**（并带随机波动）
  - 维持高含水量会比维持低含水量消耗更多的水

### 水资源获取与使用

- 物品栏每 **10 秒**自动获得 **1 罐水**
- 升级 `Unlocks.Watering` 会让每 10 秒获得的水量**翻倍**
- `use_item(Items.Water)`：在任何地块调用都可浇水
- 1 罐水提升含水量 **0.25**

### 实战建议（脚本层）

- 通常用一个阈值触发补水更稳定（例如本仓库 `consts.py` 中的 `WATER_THRESHOLD`）。
- 注意：补水逻辑是“按格子”生效的；你移动路径如果覆盖全图，每格都维持高水位会非常耗水。

## 肥料（Fertilizer）

### 获取与使用

- 与水类似：物品栏每 **10 秒**自动获得 **1 份肥料**，每次升级数量翻倍
- `use_item(Items.Fertilizer)`：
  - 将无人机脚下植物的**剩余生长时间缩短 2 秒**

### 副作用：感染与奇异物质

- 施肥加速生长的植物会被**感染**
- 感染植物收获时：有 **一半产量**会变成 `Items.Weird_Substance`
- `Items.Weird_Substance` 的效果：
  - 会**切换**该植物及其四邻（上下左右）植物的感染状态
  - 在受感染植物上使用：会“治愈该植物”，但可能感染健康邻居（反之亦然）

### 实战建议（脚本层）

- 肥料适合用在“等待最卡效率”的作物上；并且如果你需要 `Items.Weird_Substance`，可以**主动施肥**来让收获转化出奇异物质。
- **施肥时机很关键**：通常应在“刚种下去/刚补种完”的同一格立刻施肥；如果你绕一圈回来才施肥，很多作物可能已经成熟，肥料就浪费了。
- 若你计划用 `Weird_Substance` 控制感染状态，建议先在小区域验证传播效果再扩大范围（避免整片被反复切换）。
- 本仓库当前实现（可调参）：
  - 对 **胡萝卜/仙人掌** 这类“可接受感染”的作物更积极施肥（肥料库存高时主动消耗以产出奇异物质）
  - 避免对向日葵施肥（防止能量产出被折损）

## 向日葵（Sunflower）与能量（Power）

### 基本规则

- 种植方式与胡萝卜/南瓜相同：
  - 需要先确保 `Grounds.Soil`（注意 `till()` 是开关，避免二次 till 切回草地）
  - `plant(Entities.Sunflower)`
- 收获产出：收获成熟向日葵会获得能量（`Items.Power`）
- 花瓣测量：
  - `measure()` 返回无人机脚下向日葵的花瓣数
  - 花瓣数范围：**7 ~ 15**
  - 未完全成熟前也可以测量

### 8 倍能量规则（高优先级）

- 若农场上至少有 **10** 株向日葵，并且你收获的是“花瓣数量最多”的那株，则获得 **8 倍能量**
- 若你收获时场上存在另一株花瓣更多的向日葵，则你**接下来**收获的向日葵只能获得普通能量（没有 8 倍）
- 允许并列最大：如果有多株花瓣数并列最高，收获任意一株都等价

### 能量与加速

- 只要有能量，无人机以 **2× 速度**运行
- 无人机每 **30 次行动**（移动、收获、种植等）消耗 **1 点能量**

### 实战建议（脚本层）

- 想稳定拿 8 倍：应先遍历/记录花瓣最大值，再回收“最大花瓣”的那一株（允许并列）。
- 如果你实现了“边走边收”的逻辑，很容易因为顺序问题错过 8 倍；更稳的是“先测量，再选择目标收割”。
- 本仓库当前实现：对向日葵点位会先 `measure()` 缓存花瓣数；当场上向日葵数量达到 10 后，只收割“最大花瓣”的成熟向日葵。
